# collon-haskell

# Основа

Команды определены с помощью типа `Command`:

- **Операции над стеком:**
  - `Push Int` — добавить элемент на стек.
  - `Pop` — удалить верхний элемент.

- **Арифметические операции:**
  - `Add` — сложение двух верхних элементов.
  - `Sub` — вычитание верхнего элемента из следующего.
  - `Mul` — умножение двух верхних элементов.
  - `Div` — деление второго элемента на верхний.

- **Манипулирование стеком:**
  - `Swap` — поменять два верхних элемента местами.

- **Сравнения:**
  - `Lt` — меньше (`x < y`).
  - `Gt` — больше (`x > y`).
  - `Eq` — равно (`x == y`).

- **Условные операторы и циклы:**
  - `If [Command] [Command]` — условный оператор (выполняет первый список команд, если верхний элемент не равен 0, иначе второй).
  - `DoILoop [Command]` — цикл `DO I LOOP` (выполняет команды, пока верхний элемент стека не равен 0).

- **Ввод-вывод:**
  - `Print String` — вывод строки в консоль.

---

### **Ошибки**
Тип `Error` определяет возможные ошибки:
- `EmptyStack` — операция невозможна из-за пустого стека.
- `DivideByZero` — деление на ноль.
- `InsufficientArgs` — недостаточно аргументов для выполнения команды.
- `InvalidCommand` — неверная команда.

---

1. **`runCommand`**  
   Выполняет одну команду над стеком.  
   Возвращает результат выполнения или ошибку.

2. **`runProgram`**  
   Последовательно выполняет список команд.  
   Возвращает финальное состояние стека или ошибку.

3. **`parseCommand`**  
   Парсит строковое представление команды в тип `Command`.

4. **`readCommands`**  
   Считывает команды из пользовательского ввода.

5. **`main`**  
   Запускает интерпретатор. Пользователь вводит команды и начальное состояние стека, после чего программа выполняет команды и выводит финальный стек.

---

### **Стек**
- Стек представлен типом `[Int]`.  
  Верхний элемент стека находится в начале списка.

---

## **Пример работы**
![Пример работы](https://github.com/user-attachments/assets/63444a39-56e6-4929-a6dd-8bb26806e26f)

# Тестирование

- Арифметические операции (`+`, `-`, `*`, `/`, `MOD`).
- Манипуляции со стеком (`DUP`, `DROP`, `SWAP`, `OVER`, `ROT`).
- Условные операторы (`buzz?`, `is-it-zero?`).
- Определение новых слов.

- Используемые библиотеки:
  - `Test.Hspec` для тестирования.
  - `Data.List`, `Data.Map` и другие стандартные модули.
 
Функция `interpret` принимает строку с инструкциями и возвращает либо результат обработки стека, либо ошибку.

## **Пример использования**

![Пример использования](https://github.com/user-attachments/assets/6f74f188-06d9-432e-8849-357c21cdab70)

# Комбинирование монад
1. **Добавление нового слова**:
   - Добавляет слово и его определение в словарь.
   - Если слово уже существует, возвращается ошибка.

2. **Получение определения слова**:
   - Извлекает определение слова из словаря.
   - Если слово не найдено, возвращается ошибка.

3. **Интерактивный режим**:
   - Позволяет пользователю добавлять и получать слова в режиме консоли.

## **Структура данных**

- **Словарь (`Dictionary`)**: 
  Представлен в виде `Map String String`, где ключ — это слово, а значение — его определение.
  
- **Стек (`Stack`)**: 
  Список целых чисел, который может использоваться для хранения временных данных.

- **Типы ошибок**:
  ```haskell
  data Error = WordExists    -- Слово уже существует
             | WordNotFound  -- Слово не найдено
             deriving (Show)
  
## **Пример использования**

![Снимок экрана 2024-12-24 в 20 51 10](https://github.com/user-attachments/assets/e9a12a98-04d2-4c07-9ee3-9e69741cff97)

# Парсинг

1. **Парсинг текста программы**:
   - Разбор строк, представляющих команды, в соответствующий тип данных `Command`.

2. **Обработка команд**:
   - Выполнение команд для управления стеком.

3. **Парсинг комментариев**:
   - Удаление однострочных и многострочных комментариев.

4. **Тесты в виде файлов**:
   - Чтение текста программы и начального стека из файлов для выполнения.

---

## **Структура данных**

- **Тип команд (`Command`)**:
  ```haskell
  data Command
      = Push Int         -- Добавить элемент в стек
      | Pop              -- Удалить верхний элемент стека
      | Add              -- Сложить два верхних элемента стека
      | Sub              -- Вычесть верхний элемент из второго
      | Mul              -- Перемножить два верхних элемента
      | Div              -- Разделить второй элемент на верхний
      | Swap             -- Поменять местами два верхних элемента
      | Lt               -- Проверить, меньше ли второй элемент, чем верхний
      | Gt               -- Проверить, больше ли второй элемент, чем верхний
      | Eq               -- Проверить равенство двух верхних элементов
      | If [Command] [Command] -- Условный оператор
      | DoILoop [Command] -- Цикл `do` с проверкой
      | Print String      -- Вывод строки (без изменения стека)
      deriving (Show, Eq)

## **Пример использования**

```txt
Push 5
-- Это однострочный комментарий
Push 10
{-
   Это многострочный комментарий,
   который будет проигнорирован
-}
Add
Print "Stack after add"
```

![Пример использования](https://github.com/user-attachments/assets/861914e7-5141-4a42-9c23-344ab1f4c7ad)

# ToDo
